<!--This file created by AppleWorks HTML Filter 6.0--><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><TITLE>PropertiesValuesActions</TITLE><link rel="stylesheet" href="basic.css" type="text/css"></HEAD><BODY  >		<a name="FirewallProperties"></a>		<h1>Firewall Properties, Values, and Actions</h1>		<p>This section provides more detailed descriptions of the properties, values, and actions used to build firewall rules.</p>		<h2>Properties and Values</h2>		<p>Properties specify a characteristic of a packet or firewall rule to be matched.  In addition to specifying a property and a value, we specify the relationship between them to form a predicate that is either true or false. The following properties are recognized at this time.</p>		<p><B>Any</B> - use this property to match any packet.  This is convenient for grouping rules or attaching additional actions that don&#146;t need to match any further conditions.</p>		<p><B>None</B> - use this property to not match any packet.</p>		<p><B>Direction</B> - use this property to specify the direction of network traffic. Inbound means from a network to the TCP/IP stack.  Outbound means from the TCP/IP stack to a network.</p>		<p><b>Interface</b> - use this property to match which networt port or data link a packet is traversing such as &quot;en0&quot; for Ethernet built-in.  You can also match the &quot;external&quot; or &quot;internal&quot; attribute of the corresponding interface.  It is common to treat packets arriving from an &quot;external&quot; interface differently from those traversing an &quot;internal&quot; interface.  If you have more than one internal or external interface, it is easier to match this attribute than list all the corresponding network ports.</p>		<p><B>Include</B> - use this property to search whether a packet matches information included within a dynamic state table such as the triggered address table, keep address table, authorize address table, or connection state table.</p>		<p><B>Source MAC Address</B> - use this property to specify an Ethernet Hardware Address that matches the source MAC (Media Access Control) address in the link layer frame header.  The hardware address of the attached Ethernet interfaces is listed for you under the value popup.  You can list the hardware addresses of other hosts on your LAN using the Address Scan tool to perform a &#147;Look Around&#148; scan.</p>		<p><B>Destination MAC Address</B> - use this property to specify an Ethernet Hardware Address that matches the destination MAC (Media Access Control) address in the link layer frame header.  The hardware address of the attached Ethernet interfaces is listed for you under the value popup.  You can list the hardware addresses of other hosts on your LAN using the Address Scan tool to perform a &#147;Look Around&#148; scan.</p>		<p><B>Source Net</B> - use this property to specify a single IP address or network range that matches the source IP address of a packets IP header.  Network ranges can be specified as address1-address2 or address/prefix_length. The directly attached networks are listed for you under the value popup.</p>		<p><B>Destination Net</B> - use this property to specify a single IP address or network range that matches the destination IP address of a packets IP header  Network ranges can be specified as address1-address2 or address/prefix_length. The directly attached networks are listed for you under the value popup.</p>		<p><B>Protocol</B> - use this property to specify the protocol number that appears in a packets IP header.  The protocol values for TCP, UDP, ICMP, and GRE are listed for you under the value popup.</p>		<p><B>Fragment Offset</B> - use this property to specify the fragment offset that appears in a packets IP header.  Typical values are listed for you under the value popup.</p>		<p><B>IP Options</B> - use this property to specify the IP option numbers that appear in a packets IP header.  Typical option values are listed for you under the value popup.  Note the option name in parenthesis is ignored.  You can list more than one option as a comma separated list.  If the specified relation is equal, packets that contain all the listed options will match.  If the specified relation is not equal, packets that contain none of the specified options will match.</p>		<p><B>ICMP Type</B> - use this property to specify the ICMP type that appears in a packets ICMP header.  Typical values are listed for you under the value popup.</p>		<p><B>ICMP Code</B> - use this property to specify the ICMP code that appears in a packets ICMP header.  Typical values are listed for you under the value popup.</p>		<p><B>TCP Header Flags</B> - use this property to specify the TCP header flags that appear in a packets TCP header.  Typical values are listed for you under the value popup.  You can list more than one flag as a comma separated list.  Flags preceded by a minus sign must be turned off in the TCP header.  Flags listed without a minus sign must be turned on.  Flags not listed can be either off or on.  This property checks for protocol=TCP, so you don&#146;t need to test this in a separate step.</p>		<p><B>TCP Options</B> - use this property to specify the TCP option numbers that appear in a packets TCP header.  Typical option values are listed for you under the value popup.  Note the option name in parenthesis is ignored.  You can list more than one option as a comma separated list.  If the specified relation is equal, packets that contain all the listed options will match.  If the specified relation is not equal, packets that contain none of the specified options will match.  This property checks for protocol=TCP, so you don&#146;t need to test this in a separate step.</p>		<p><B>Source Port</B> - use this property to specify a single protocol port or range of protocol ports that matches the source port of a packets TCP or UDP header.  Port ranges can be specified as port1-port2.  Typical values are listed for you under the value popup.</p>		<p><B>Destination Port</B> - use this property to specify a single protocol port or range of protocol ports that matches the destination port of a packets TCP or UDP header.  Port ranges can be specified as port1-port2.  Typical values are listed for you under the value popup.</p>		<p><B>Data Content</B> - use this property to specify a string of characters you want to match within the TCP or UDP packet data. Typical values are shown for you under the value popup.  By default, the first 64 bytes of data content will be examined.  You can specify an optional search starting position (search offset), search length, and terminating character in square brackets as shown. If you precede the search offset by a plus (+) or minus (-) sign, it becomes a relative offset from the last position in this packet that was matched.  For example, you could search for the string &#147;Host:&#148; from position 100-300 as &#147;[100,200]Host:&#148;, and then search for a URL that immediately follows containing xxx as &#147;[+5,128,13]xxx&#148;. xxx must appear within the next 128 characters following &#147;Host:&#148; up to the first carriage return (character code 13).  If you specify relation &#147;a=A&#148;, matching is not case sensitive.</p>		<p><B>URL Keyword</B> - use this property to search for keywords that appear within a HTTP (web site) URL.  Some typical values are listed for you under the value popup.  For example, you could specify &#147;doubleclick.net&#148; to block banner advertisements from this aggregator.</p>		<p><B>Time of Day</B> - use this property to restrict or allow specified network traffic based on the time of day.  Typical values are shown for you under the value popup.  Notice all times are specified in 24-hour format.</p>		<p><B>Day of Week</B> - use this property to restrict or allow specified network traffic based on the day of the week.  Typical values are shown for you under the value popup.</p>		<p><B>Date and Time</B> - use this property to restrict or allow specified network traffic up to a designated date and time  A recent date and time is shown as an example under the value popup.  Using this property, you can create temporary rules that expire at a specified time.  For example, you might want to allow a guest to access your network for a limited time.  By having the rule expire automatically, you don&#146;t have to remember to remove it later. </p>		<p><B>Idle Seconds</B> - use this property to notify you if a rule has not been matched for some specified interval.  Notice this rule can be matched without a packet being present.  Idle time is normally checked every 10 seconds.  If the rule matches the idle time will be reset to zero so it can match periodically at the specified interval.</p>		<p><B>Parent Idle Seconds</B> - use this property to notify you if the parent rule has not been matched for some specified interval.  Notice this rule can be matched without a packet being present.  We test the idle seconds of the parent rule that looks for specified traffic once every 10 seconds so this rule can be used to specify an idle interval.  If the parent rule specifies the &#147;Include&#148; property, we test against the match count of the corresponding table entry if any.</p>		<p><B>Parent Match Count</B> - use this property to notify you if the parent rule has been matched a specified number of times.  We test the match count of the parent rule that looks for specified traffic so this rule can be used to specify the match count.  If the parent rule specifies the &#147;Include&#148; property, we test against the match count of the corresponding table entry if any.</p>		<p><B>Parent Byte Count</B> - use this property to notify you if the parent rule has been matched by network traffic containing a specified number bytes (amount of traffic).  We test the byte count of the parent rule that looks for specified traffic so this rule can be used to specify the byte count.</p>		<h2>Actions</h2>		<p>Actions specify what action if any is to be taken when a firewall rule is matched.  The following actions are supported at this time:</p>		<p><B>-&gt;</B> proceed to rule at the next level (child) if any.</p>		<p><B>Group</B> begin a group of related rules.</p>		<p><b>Exit group</b> skip to the end of the preceding Group.</p>		<p><B>Pass</B> - allow this packet through without matching against other rules at the same or previous level. The Pass action is normally not logged.</p>		<p><B>Delete</B> - delete this packet without matching against other rules at the same or previous level.  The delete action is normally logged.</p>		<p><B>Reject</B> - respond to this packet with a TCP RESET segment and then delete the original packet without matching against other rules at the same or previous level.  The Reject action is normally logged.  This action is intended to explicitly refuse connections.  [Note: Reject should not be used on an interface that is set to promiscuous mode as it may refuse connections not addressed to this interface.]</p>		<p><B>Drop connection</B> - drop the corresponding TCP connection to block access and clear the corresponding TCP connection state.  For inbound packets, dropping the connections sends a TCP RESET to the local endpoint.  For outbound packets, dropping the connection sends a TCP FIN segment as a response to the local endpoint and deletes the original packet.  If the outbound packet is a web request, a &#147;Blocked by IPNetSentry&#148; page is displayed.  The drop connection action is normally logged.</p>		<p><B>Keep Address</B> - add the packets source IP address to the Keep Address table. Normally addresses remain in the Keep Address table for 1 hour or until pushed out by more recently used entries. You can examine or modify the Keep Address table using the &#147;Triggered&#148; tab view to examine entries of type &#147;address&#148;.</p>		<p><B>Authorize</B> - add the packets source IP address to the Authorize address table. Normally addresses remain in the Authorize address table for 1 hour or until pushed out by more recently used entries. You can examine or modify the Authorize address table using the &#147;Triggered&#148; tab view to examine entries of type &#147;authorize&#148;.</p>		<p><B>Trigger</B> - add the packets source IP address to the Triggered Address table and delete the original packet. Normally addresses remain in the Triggered Address table for 1 hour or until pushed out by more recently used entries. The Triggered Address table can hold up to 2000 entries. You can examine or modify the Triggered Address table and delete individual addresses using the &#147;Triggered&#148; tab view. The trigger action is normally logged.</p>		<p><B>Delay</B> - hold this packet for approximately .75 seconds before delivering normally.  This action can be used to ignore promiscuous resets from a hostile firewall.  Some firewalls can send TCP RESET segments when denying access.  If the interface running such a firewall is set to promiscuous mode, the firewall may send TCP RESET segments in response to connection requests that were not originally addressed to that host.  The symptom is frequent &#147;Connection refused&#148; responses when trying to access remote servers.  By delaying such TCP RESET segments, we allow the actual target of the connection request (if any) to respond first completing the connection process.  When the RESET arrives, it will be safely ignored as out of order if the target host has already responded.  The Delay Table can hold up to 30 packets at which point the firewall will simply log that the delay table is full.  This prevents delayed packets from consuming vast amounts of kernel memory.</p>		<p><B>Rate Limit In/Out </B>- allows you to specify the maximum bandwidth (bits/second) available to matching TCP/IP connections. The bandwidth is specified in the parameter field. You can use &#147;K&#148; or &#147;M&#148; immediately following a string of digits to specify Kilobytes or Megabytes as in &#147;100K&#148; or &#147;1M&#148;. IPNetSentryX provides TCP rate limiting (pacing) by adjusting the advertised window size of packets from corresponding matching connections. As packets match a Rate Limit rule, the corresponding connection table entry is set to point to that rule. When the connection table is aged, a tally of the active connections (that exceed a traffic threshold) is calculated for that rule and the available bandwidth is divided evenly among the corresponding connections. See <a href="http://www.sustworks.com/site/app_note_1006.html">Application Note 1006: Using Bandwidth Allocation</a> for more information.</p>		<p><b>Route to</b> - allows you to specify the IP address of the next hop router or gateway (must be on a directly attached IP subnet).  Routing in TCP/IP is normally based on the destination IP address.  The &quot;Route to&quot; action allows you to override this default behavior based on any packet attributes you select such as the protocol port or service (Email, Web, FTP, etc.).</p>		<p><B>Log</B> - log this packet.  Note the Log action does not prevent the packet from being matched against other rules at the same or previous levels.  Subsequent rules may specify additional actions. You can choose the logging format in the Preferences window.  The options are:</p>		<BLOCKQUOTE>			&#147;Property List&#148; which provides detailed packet information as a NeXT style property list that is easily parsed by other programs;			<p>&#147;Text&#148; which provides detailed packet information in an easy to read form.</p>			<p>&#147;Unix System Log (ipfw)&#148; which follows the common Unix System Log format for compatibility with other unix utilities. This format can be used with Open Door Networks &#147;Who&#146;s There&#148; firewall advisor.</p>		</BLOCKQUOTE>		Logged text is normally buffered in memory to avoid frequent disk access. Use the Preferences window to specify what should be done when the log buffer becomes full.  Options include save to disk or send as E-mail.		<p><B>Don&#146;t log </B>- mark this packet so it will not be logged by a subsequent leaf action such as delete.  This action allows you to silently delete known unwanted packets. Any leaf action that would normally log a packet can be made silent by including this action as one of its parents or children. Notice that when a matching rule specifying a leaf action such as delete is encountered, any children of that rule will still be matched before the leaf action is performed. This allows you do specify multiple actions for a single condition. See Terminating and Multiple Actions under &#147;IPNetSentryX Firewall Concepts.&#148; </p>		<p><B>Alert </B>- display an on-screen alert indicating which rule was matched (by number, name, and parameter).</p>		<p><B>E-mail</B> - send an E-mail message with the corresponding log entry and subject &#147;IPNetSentry Security Alert&#148;.  If the Parameter field contains an E-mail address, the message will be sent to that destination.  Otherwise the message is sent to the log file destination specified in the Preferences window.  This allows you to alert different administrators or take different actions based on what rule was matched.  Many cell phones can be used as a pager by e-mailing a short message.</p>		<p><B>URL</B> - try to invoke the URL specified in the parameter field.  Currently this recognizes URLs of the form:</p>		<ul>			<li type="disc">ping://name_or_address			<li type="disc">lookup://name_or_address			<li type="disc">tcp://address:port			<li type="disc">ftp://network_location/path_name			<li type="disc">http://network_location/path_name		</ul>				to invoke a network probe. Other URL schemes are passed on to Mac OS X&#146;s launch services to be opened by an appropriate helper application.		<p>In some cases, Launch Services may not be configured to launch the desired application. In this case, you can use the More Internet Pref panel &lt;http://www.monkeyfood.com/software/moreInternet/&gt; to examine or change the mapping of URL schemes to helper applications. Alternatively, you can examine ~/library/preferences/com.apple.LaunchServices.plist to remove the previous mapping and then launch the desired application to register a new one.</p>		<p><B>Reset Parent</B> - reset the match count of the parent rule to zero.  You can use this action to create rules that notify you only once each time a server goes quiet.  Consider the following example:</p>		<BLOCKQUOTE>Rules that test for server response<BR><BLOCKQUOTE>If (parent idle time &gt; 2 minutes) URL&#147;scan&#148; to send a probe<BR>if (parent idle time &gt; 4 minutes) -&gt;<BR><BLOCKQUOTE>if (parent match count == 1) send E-mail &#147;server is down&#148;<BR>if (parent idleTime &gt; 1 hour) reset parent<BR></BLOCKQUOTE></BLOCKQUOTE></BLOCKQUOTE>		The first rule (and its ancestors) look for a specific server response.  If the response has not been seen in over 2 minutes, send a network probe. The probe is repeated every 10 seconds when the idle time is checked until the first rule detects a server response.  If there is still no response after 4 minutes (2 minutes of probing), proceed to the next child.  If this is the first time the server failed to respond, send an E-mail reporting the server is down.  Finally, if the server has been responding for over an hour (the 3rd rule is no longer being matched), reset the match count of the parent so we can be notified again if the server goes quiet.		<p><B>AppleScript</B> - execute an AppleScript to perform other notification actions. Use the Default AppleScript file specified in the preferences window, or a file in the same directory whose filename is specified in the Parameter field.</p>		<hr>		<p><a href="FirewallDocument.html">Previous</a> | <a href="LookupHelp.html">Next</a> | <a href="../NMTitle.html">Return to IPNetSentryX Help</a></p>		<p></p>	</BODY></HTML>